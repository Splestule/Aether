@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html,
  body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    font-family:
      'IBM Plex Mono', 'Space Mono', 'Roboto Mono', 'SFMono-Regular', Menlo, Monaco, Consolas,
      monospace;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    background:
      radial-gradient(120% 120% at 50% -10%, rgba(198, 160, 232, 0.25), transparent 60%), #030712;
    color: #f8fafc;
  }

  #root {
    height: 100vh;
    width: 100vw;
  }

  .particle-field {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 0;
    filter: blur(0.2px);
  }
}

@layer components {
  .vr-button {
    @apply inline-flex items-center justify-center gap-2 px-5 py-3 rounded-lg border border-white/60 bg-[rgba(26,26,26,0.92)] text-white font-medium uppercase tracking-[0.22em] text-[0.65rem] transition-all duration-300 shadow-[0_0_30px_rgba(198,160,232,0.2)] hover:bg-white/10 hover:border-white hover:text-[#c6a0e8] focus:outline-none focus-visible:ring-2 focus-visible:ring-white/60 focus-visible:ring-offset-2 focus-visible:ring-offset-black disabled:opacity-40 disabled:cursor-not-allowed;
  }

  .vr-panel {
    @apply bg-[rgba(26,26,26,0.92)] border border-white/50 rounded-xl backdrop-blur-lg shadow-[0_24px_55px_rgba(15,23,42,0.55)] text-white;
    letter-spacing: 0.08em;
  }

  .flight-info-card {
    @apply bg-[rgba(26,26,26,0.94)] border border-white/50 rounded-2xl backdrop-blur-xl shadow-[0_28px_65px_rgba(15,23,42,0.6)] p-5 min-w-[320px] text-white;
    letter-spacing: 0.08em;
  }

  .vr-icon-button {
    @apply flex h-9 w-9 items-center justify-center rounded-full border border-white/40 bg-transparent text-white/70 transition-colors duration-300 hover:border-white hover:text-[#c6a0e8] focus:outline-none focus-visible:ring-2 focus-visible:ring-white/50 focus-visible:ring-offset-2 focus-visible:ring-offset-black;
  }

  .compass-heading {
    @apply font-semibold uppercase tracking-[0.32em] text-xs text-white/70;
  }

  .compass-title {
    @apply font-semibold uppercase tracking-[0.28em] text-base text-white;
  }

  .compass-subtle {
    @apply uppercase tracking-[0.2em] text-[0.6rem] text-white/60;
  }

  .brand-header {
    letter-spacing: 0.08em;
  }

  .brand-logo {
    filter: drop-shadow(0 20px 45px rgba(56, 189, 248, 0.25));
  }

  .brand-title {
    font-family: 'Unbounded', 'Stack Sans Notch', 'Gabarito', 'Inter', 'Helvetica Neue', sans-serif;
    font-weight: 500;
    letter-spacing: 0.08em;
    text-transform: none;
  }

  .responsive-map-container {
    height: min(20rem, calc(100vh - 28rem));
    max-height: calc(100vh - 28rem);
  }

  @media (min-width: 640px) {
    .responsive-map-container {
      height: min(24.6rem, calc(100vh - 23rem));
      max-height: calc(100vh - 23rem);
    }
  }
}

/* Leaflet map styles */
.leaflet-container {
  height: 100%;
  width: 100%;
}

/* Make map tiles greyscale with reduced saturation (70% greyscale) */
.leaflet-container .leaflet-tile-container img {
  filter: grayscale(70%) brightness(0.9) contrast(1.1);
  transition: filter 0.3s ease;
}

/* Custom purple marker styling - remove all borders and backgrounds */
/* Note: Don't override margin - Leaflet uses margin to position the anchor point */
.leaflet-div-icon.custom-purple-marker {
  background: transparent !important;
  background-color: transparent !important;
  border: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  outline: none !important;
  padding: 0 !important;
  /* Don't override margin - Leaflet applies margin based on iconAnchor */
  width: 25px !important;
  height: 41px !important;
  line-height: 0 !important;
  overflow: visible !important;
}

/* Don't override margin on inner content - let Leaflet handle positioning */
.custom-purple-marker {
  background: transparent !important;
  background-color: transparent !important;
  border: none !important;
  padding: 0 !important;
  /* Don't override margin - Leaflet applies it via inline styles for anchor positioning */
  width: 25px !important;
  height: 41px !important;
  line-height: 0 !important;
}

/* Ensure the inner div also has no styling */
.custom-purple-marker > div {
  background: transparent !important;
  border: none !important;
  padding: 0 !important;
  /* Don't override margin here either */
  width: 25px !important;
  height: 41px !important;
}

.custom-purple-marker svg {
  display: block;
  pointer-events: none;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.4));
  width: 25px;
  height: 41px;
  overflow: visible;
  vertical-align: top;
}

.leaflet-popup-content-wrapper,
.leaflet-popup-tip {
  background: transparent;
  box-shadow: none;
  border: none;
  padding: 0;
}

.leaflet-popup-content {
  margin: 0 !important;
  width: auto !important;
  padding: 0 !important;
}

.leaflet-popup-close-button {
  display: none;
}

/* VR-specific styles */
.vr-canvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
}

.vr-ui {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 10;
  pointer-events: none;
}

.vr-ui > * {
  pointer-events: auto;
}

/* Loading animation */
.loading-spinner {
  @apply animate-spin rounded-full h-8 w-8 border-2 border-white/20 border-t-white;
}

/* Hide react-three/xr built-in AR button on mobile when flight is selected */
/* The ARCanvas from react-three/xr renders its button with specific classes */
@media (max-width: 639px) {
  body.flight-selected button[class*='xr-button'],
  body.flight-selected button[class*='ar-button'],
  body.flight-selected [data-ar-button],
  body.flight-selected button:has-text('Enter AR'),
  body.flight-selected button:has-text('AR unsupported') {
    display: none !important;
    opacity: 0 !important;
    pointer-events: none !important;
    visibility: hidden !important;
  }

  /* Target common react-three/xr button patterns */
  body.flight-selected canvas + div button,
  body.flight-selected [style*='position: fixed'] button[style*='bottom'] {
    display: none !important;
    opacity: 0 !important;
    pointer-events: none !important;
    visibility: hidden !important;
  }
}
